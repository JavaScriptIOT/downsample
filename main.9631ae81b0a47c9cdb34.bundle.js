(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{226:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const normalizeX=x=>x instanceof Date?x.getTime():x;function normalizeDataPoint(dataPoint){if(dataPoint){if((dataPoint=>!!dataPoint&&"x"in dataPoint&&"y"in dataPoint)(dataPoint))return[normalizeX(dataPoint.x),dataPoint.y];if((dataPoint=>Array.isArray(dataPoint))(dataPoint))return[normalizeX(dataPoint[0]),dataPoint[1]];throw new Error(`Invalid data point format supplied: ${JSON.stringify(dataPoint)}`)}}exports.normalizeDataPoint=normalizeDataPoint,exports.normalizeDataPoints=function normalizeDataPoints(dataPoints){return dataPoints.map(normalizeDataPoint).filter(Boolean)},exports.calculateTriangleArea=function calculateTriangleArea(pointA,pointB,pointC){return Math.abs((pointA[0]-pointC[0])*(pointB[1]-pointA[1])-(pointA[0]-pointB[0])*(pointC[1]-pointA[1]))/2},exports.calculateAverageDataPoint=function calculateAverageDataPoint(...points){const{length:length}=points;if(!length)return;let averageX=0,averageY=0;for(let i=0;i<length;i++)averageX+=points[i][0],averageY+=points[i][1];return[averageX/length,averageY/length]},exports.splitIntoBuckets=function splitIntoBuckets(data,desiredLength){if(2===data.length)return[[data[0]],[data[1]]];const first=data[0],center=data.slice(1,data.length-1),last=data[data.length-1],bucketSize=center.length/(desiredLength-2),splitData=[[first]];for(let i=0;i<desiredLength-2;i++){const bucketStartIndex=Math.floor(i*bucketSize),bucketEndIndex=Math.floor((i+1)*bucketSize),dataPointsInBucket=center.slice(bucketStartIndex,bucketEndIndex);splitData.push(dataPointsInBucket)}return splitData.push([last]),splitData}},353:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=__webpack_require__(226);function LTTBIndexesForBuckets(buckets){const bucketCount=buckets.length,bucketDataPointIndexes=[0];let previousBucketsSize=1,lastSelectedDataPoint=buckets[0][0];for(let index=1;index<bucketCount-1;index++){const bucket=buckets[index],nextBucket=buckets[index+1],averageDataPointFromNextBucket=utils_1.calculateAverageDataPoint(...nextBucket);if(void 0===averageDataPointFromNextBucket)continue;let maxArea=-1,maxAreaIndex=-1;for(let j=0;j<bucket.length;j++){const dataPoint=bucket[j],area=utils_1.calculateTriangleArea(lastSelectedDataPoint,dataPoint,averageDataPointFromNextBucket);area>maxArea&&(maxArea=area,maxAreaIndex=j)}lastSelectedDataPoint=bucket[maxAreaIndex],bucketDataPointIndexes.push(previousBucketsSize+maxAreaIndex),previousBucketsSize+=bucket.length}return bucketDataPointIndexes.push(previousBucketsSize),bucketDataPointIndexes}exports.LTTBIndexesForBuckets=LTTBIndexesForBuckets,exports.default=function LTTB(data,desiredLength){if(desiredLength<0)throw new Error(`Supplied negative desiredLength parameter to LTTB: ${desiredLength}`);const{length:length}=data;if(length<=1||length<=desiredLength)return data;const normalizedData=utils_1.normalizeDataPoints(data);return LTTBIndexesForBuckets(utils_1.splitIntoBuckets(normalizedData,desiredLength)).map(index=>data[index])}},391:function(module,exports,__webpack_require__){__webpack_require__(392),__webpack_require__(537),__webpack_require__(538),__webpack_require__(683),module.exports=__webpack_require__(692)},456:function(module,exports){},538:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const StorybookDecorator_1=__webpack_require__(539);__webpack_require__(229).addDecorator(StorybookDecorator_1.StorybookDecorator)},539:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(281),react_1=tslib_1.__importDefault(__webpack_require__(1)),styled_components_1=tslib_1.__importStar(__webpack_require__(541));exports.StorybookDecorator=storyFn=>react_1.default.createElement(Container,null,react_1.default.createElement(StorybookDefaultStyle,null),storyFn());const Container=styled_components_1.default.div`
  padding: 20px;
`,StorybookDefaultStyle=styled_components_1.createGlobalStyle`
  html {
    font-family: Roboto, 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  body {
    padding: 0;
    margin: 0;
  }

  * {
    box-sizing: border-box;
  }
`},692:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(229);module._StorybookPreserveDecorators=!0,Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)([__webpack_require__(694)],module)}.call(this,__webpack_require__(693)(module))},694:function(module,exports,__webpack_require__){var map={"./Downsample.stories.tsx":695};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=694},695:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(281),src_1=__webpack_require__(696),recharts_1=__webpack_require__(810),addon_knobs_1=__webpack_require__(351),utils_1=__webpack_require__(809),react_1=tslib_1.__importStar(__webpack_require__(1));exports.default={title:"Welcome"},exports.ToStorybook=()=>{const showLTD=addon_knobs_1.boolean("Show LTD",!0),showLTOB=addon_knobs_1.boolean("Show LTOB",!0),showLTTB=addon_knobs_1.boolean("Show LTTB",!0),numRawDataPoints=(addon_knobs_1.boolean("Show ASAP",!0),addon_knobs_1.number("Number of original data points",1e3)),numDownsampledDataPoints=addon_knobs_1.number("Number of downsampled data points",10),data=react_1.useMemo(()=>utils_1.generateRandomData(numRawDataPoints),[numRawDataPoints]),downsampledLTOB=showLTOB?src_1.LTOB(data,numDownsampledDataPoints):[],downsampledLTTB=showLTTB?src_1.LTTB(data,numDownsampledDataPoints):[],downsampledLTD=showLTD?src_1.LTD(data,numDownsampledDataPoints):[],downsampledData=data.map(dataPoint=>{const dataPointLTOB=downsampledLTOB.find(({x:x})=>x===dataPoint.x),dataPointLTTB=downsampledLTTB.find(({x:x})=>x===dataPoint.x),dataPointLTD=downsampledLTD.find(({x:x})=>x===dataPoint.x);return{...dataPoint,ltd:dataPointLTD?dataPointLTD.y:void 0,ltob:dataPointLTOB?dataPointLTOB.y:void 0,lttb:dataPointLTTB?dataPointLTTB.y:void 0}});return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("h1",null,"Welcome to Downsample"),react_1.default.createElement("p",null,"This is an interactive showcase of ",react_1.default.createElement("code",null,"downsample")," package functionality."),react_1.default.createElement(recharts_1.ResponsiveContainer,{height:320},react_1.default.createElement(recharts_1.LineChart,{margin:{top:20,right:20,left:20},data:downsampledData},react_1.default.createElement(recharts_1.XAxis,{dataKey:"x"}),react_1.default.createElement(recharts_1.YAxis,null),react_1.default.createElement(recharts_1.Legend,null),react_1.default.createElement(recharts_1.Tooltip,null),react_1.default.createElement(recharts_1.Line,{dot:!1,type:"linear",dataKey:"y",stroke:"#061766",isAnimationActive:!1,name:"Original data"}),showLTD?react_1.default.createElement(recharts_1.Line,{dot:!1,type:"linear",dataKey:"ltd",stroke:"#FF9C00",isAnimationActive:!1,connectNulls:!0,name:"Downsampled with LTD"}):null,showLTOB?react_1.default.createElement(recharts_1.Line,{dot:!1,type:"linear",dataKey:"ltob",stroke:"#C20165",isAnimationActive:!1,connectNulls:!0,name:"Downsampled with LTD"}):null,showLTTB?react_1.default.createElement(recharts_1.Line,{dot:!1,type:"linear",dataKey:"lttb",stroke:"#00B7D9",isAnimationActive:!1,connectNulls:!0,name:"Downsampled with LTD"}):null)))},exports.ToStorybook.story={name:"to Downsample"}},696:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var LTD_1=__webpack_require__(697);exports.LTD=LTD_1.default;var LTOB_1=__webpack_require__(698);exports.LTOB=LTOB_1.default;var LTTB_1=__webpack_require__(353);exports.LTTB=LTTB_1.default},697:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const LTTB_1=__webpack_require__(353),utils_1=__webpack_require__(226);exports.mergeBucketAt=(buckets,index)=>{const bucketA=buckets[index],bucketB=buckets[index+1];if(!bucketA||!bucketB)throw new Error(`Bucket index out of range for merging: ${index} (allowed indexes are 0 - ${buckets.length-2}`);const mergedBucket=[...bucketA,...bucketB],newBuckets=buckets.slice();return newBuckets.splice(index,2,mergedBucket),newBuckets},exports.splitBucketAt=(buckets,index)=>{const bucket=buckets[index];if(!bucket)throw new Error(`Bucket index out of range for splitting: ${index} (allowed indexes are 0 - ${buckets.length-1}`);const bucketSize=bucket.length;if(bucketSize<2)return buckets;const bucketALength=Math.ceil(bucketSize/2),bucketA=bucket.slice(0,bucketALength),bucketB=bucket.slice(bucketALength),newBuckets=buckets.slice();return newBuckets.splice(index,1,bucketA,bucketB),newBuckets},exports.calculateLinearRegressionCoefficients=data=>{const N=data.length;let averageX=0,averageY=0;for(let i=0;i<N;i++)averageX+=data[i][0],averageY+=data[i][1];averageX/=N,averageY/=N;let aNumerator=0,aDenominator=0;for(let i=0;i<N;i++){const[x,y]=data[i];aNumerator+=(x-averageX)*(y-averageY),aDenominator+=(x-averageX)*(x-averageX)}const a=aNumerator/aDenominator;return[a,averageY-a*averageX]},exports.calculateSSEForBucket=dataPoints=>{const[a,b]=exports.calculateLinearRegressionCoefficients(dataPoints);let sumStandardErrorsSquared=0;for(let i=0;i<dataPoints.length;i++){const dataPoint=dataPoints[i],standardError=dataPoint[1]-(a*dataPoint[0]+b);sumStandardErrorsSquared+=standardError*standardError}return sumStandardErrorsSquared},exports.calculateSSEForBuckets=buckets=>{const sse=[0];for(let i=1;i<buckets.length-1;i++){const previousBucket=buckets[i-1],currentBucket=buckets[i],nextBucket=buckets[i+1],bucketWithAdjacentPoints=[previousBucket[previousBucket.length-1],...currentBucket,nextBucket[0]];sse.push(exports.calculateSSEForBucket(bucketWithAdjacentPoints))}return sse.push(0),sse},exports.findLowestSSEAdjacentBucketsIndex=(sse,ignoreIndex)=>{let minSSESum=Number.MAX_VALUE,minSSEIndex=void 0;for(let i=1;i<sse.length-2;i++)i!==ignoreIndex&&i+1!==ignoreIndex&&sse[i]+sse[i+1]<minSSESum&&(minSSESum=sse[i]+sse[i+1],minSSEIndex=i);return minSSEIndex},exports.findHighestSSEBucketIndex=(buckets,sse)=>{let maxSSE=0,maxSSEIndex=void 0;for(let i=1;i<sse.length-1;i++)buckets[i].length>1&&sse[i]>maxSSE&&(maxSSE=sse[i],maxSSEIndex=i);return maxSSEIndex},exports.default=function LTD(data,desiredLength){if(desiredLength<0)throw new Error(`Supplied negative desiredLength parameter to LTD: ${desiredLength}`);const{length:length}=data;if(length<=2||length<=desiredLength)return data;const normalizedData=utils_1.normalizeDataPoints(data);let buckets=utils_1.splitIntoBuckets(normalizedData,desiredLength);const numIterations=10*length/desiredLength;for(let iteration=0;iteration<numIterations;iteration++){const sseForBuckets=exports.calculateSSEForBuckets(buckets),highestSSEBucketIndex=exports.findHighestSSEBucketIndex(buckets,sseForBuckets);if(void 0===highestSSEBucketIndex)break;const lowestSSEAdajacentBucketIndex=exports.findLowestSSEAdjacentBucketsIndex(sseForBuckets,highestSSEBucketIndex);if(void 0===lowestSSEAdajacentBucketIndex)break;buckets=exports.splitBucketAt(buckets,highestSSEBucketIndex),buckets=exports.mergeBucketAt(buckets,lowestSSEAdajacentBucketIndex>highestSSEBucketIndex?lowestSSEAdajacentBucketIndex+1:lowestSSEAdajacentBucketIndex)}return LTTB_1.LTTBIndexesForBuckets(buckets).map(index=>data[index])}},698:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=__webpack_require__(226);exports.default=function LTOB(data,desiredLength){if(desiredLength<0)throw new Error(`Supplied negative desiredLength parameter to LTOB: ${desiredLength}`);const{length:length}=data;if(length<=1||length<=desiredLength)return data;const bucketSize=length/desiredLength,normalizedData=utils_1.normalizeDataPoints(data),sampledData=[data[0]];for(let bucket=1;bucket<desiredLength-1;bucket++){const startIndex=Math.floor(bucket*bucketSize),endIndex=Math.min(length-1,(bucket+1)*bucketSize);let maxArea=-1,maxAreaIndex=-1;for(let j=startIndex;j<endIndex;j++){const previousDataPoint=normalizedData[j-1],dataPoint=normalizedData[j],nextDataPoint=normalizedData[j+1],area=utils_1.calculateTriangleArea(previousDataPoint,dataPoint,nextDataPoint);area>maxArea&&(maxArea=area,maxAreaIndex=j)}sampledData.push(data[maxAreaIndex])}return sampledData.push(data[length-1]),sampledData}},809:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const getRandomNumber=(lowerBound,upperBound)=>lowerBound+Math.random()*(upperBound-lowerBound);exports.generateRandomData=length=>{const data=[];let value=getRandomNumber(0,100);for(let i=0;i<length;i++)value+=getRandomNumber(-100,100),data.push({x:i,y:value});return data}}},[[391,1,2]]]);
//# sourceMappingURL=main.9631ae81b0a47c9cdb34.bundle.js.map